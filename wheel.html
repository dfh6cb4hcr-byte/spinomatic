<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Green Shade Wheel</title>
  <style>
    :root{
      --bg0:#070A0F;
      --bg1:#0B1220;
      --card: rgba(255,255,255,0.06);
      --card2: rgba(255,255,255,0.09);
      --text:#EAF2FF;
      --muted:rgba(234,242,255,0.7);
      --accent:#7CFFB2;
      --shadow: 0 30px 80px rgba(0,0,0,0.55);
      --radius: 18px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 15%, rgba(124,255,178,0.14), transparent 55%),
        radial-gradient(900px 600px at 80% 65%, rgba(0,180,255,0.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .wrap{
      width:min(980px, 100%);
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:20px;
      align-items:stretch;
    }
    @media (max-width: 900px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .stage{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
      padding:22px;
      min-height: 520px;
    }

    .header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }
    h1{
      margin:0;
      font-size: clamp(20px, 2.2vw, 28px);
      letter-spacing:0.2px;
      line-height:1.1;
    }
    .sub{
      margin-top:8px;
      color:var(--muted);
      font-size: 13px;
      line-height:1.4;
      max-width: 52ch;
    }

    .wheel-area{
      display:grid;
      place-items:center;
      position:relative;
      margin-top:10px;
      height: 420px;
    }

    .wheel-shell{
      position:relative;
      width: 380px;
      height: 380px;
      max-width: 88vw;
      max-height: 88vw;
      border-radius: 50%;
      filter: drop-shadow(0 18px 40px rgba(0,0,0,0.55));
    }

    canvas#wheel{
      width:100%;
      height:100%;
      border-radius: 50%;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.12);
    }

    /* glossy ring */
    .ring{
      pointer-events:none;
      position:absolute;
      inset:-10px;
      border-radius:50%;
      border: 12px solid rgba(255,255,255,0.06);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.10),
        inset 0 0 30px rgba(255,255,255,0.06);
    }
    .shine{
      pointer-events:none;
      position:absolute;
      inset:0;
      border-radius:50%;
      background:
        radial-gradient(400px 220px at 35% 30%, rgba(255,255,255,0.22), transparent 55%),
        radial-gradient(300px 200px at 70% 80%, rgba(255,255,255,0.12), transparent 60%);
      mix-blend-mode: screen;
      opacity:0.55;
    }

    /* pointer */
    .pointer{
      position:absolute;
      top: 5px;
      left:50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 16px solid transparent;
      border-right: 16px solid transparent;
      border-top: 28px solid rgba(255,255,255,0.92);
      filter: drop-shadow(0 10px 10px rgba(0,0,0,0.45));
      z-index: 3;
    }
    .pointer::after{
      content:"";
      position:absolute;
      top:-34px;
      left:50%;
      transform:translateX(-50%);
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: rgba(255,255,255,0.92);
      box-shadow: 0 10px 20px rgba(0,0,0,0.35), inset 0 -2px 6px rgba(0,0,0,0.25);
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      margin-top: 10px;
    }
    button{
      appearance:none;
      border:0;
      border-radius: 999px;
      padding: 14px 18px;
      font-weight: 700;
      letter-spacing:0.3px;
      cursor:pointer;
      color:#08140D;
      background: linear-gradient(180deg, #B8FFD6, #72FFB5);
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
      transition: transform 0.12s ease, filter 0.12s ease, opacity 0.12s ease;
      min-width: 170px;
      font-size: 15px;
    }
    button:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    button:active{ transform: translateY(1px) scale(0.99); }
    button[disabled]{ opacity:0.55; cursor:not-allowed; transform:none; }

    .side{
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      position:relative;
      overflow:hidden;
      min-height: 520px;
    }

    .panel{
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 14px;
      margin-top: 12px;
    }
    .label{
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.3px;
      text-transform: uppercase;
      margin-bottom: 8px;
    }
    .chip{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px;
      border-radius: 12px;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.08);
    }
    .swatch{
      width: 46px;
      height: 46px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.25);
      box-shadow: inset 0 -6px 16px rgba(0,0,0,0.22);
      background: #2ECC71;
    }
    .hex{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    .small{
      font-size: 12px;
      color: var(--muted);
      line-height:1.4;
    }

    .divider{
      height:1px;
      background: rgba(255,255,255,0.10);
      margin: 14px 0;
    }

    /* Celebration overlay */
    .celebrate{
      position:absolute;
      inset: 14px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(10,18,28,0.82), rgba(10,18,28,0.62));
      border: 1px solid rgba(255,255,255,0.12);
      box-shadow: 0 40px 120px rgba(0,0,0,0.70);
      display:none;
      overflow:hidden;
      z-index: 5;
      backdrop-filter: blur(8px);
    }
    .celebrate.show{ display:block; animation: pop 260ms ease-out; }
    @keyframes pop{
      from{ transform: scale(0.98); opacity: 0; }
      to{ transform: scale(1); opacity: 1; }
    }

    .celebrate-inner{
      position:relative;
      height:100%;
      padding: 18px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .celebrate-top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
    }
    .celebrate h2{
      margin: 0;
      font-size: 18px;
      letter-spacing: 0.2px;
    }
    .close{
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.08);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      cursor:pointer;
      font-weight: 700;
      min-width: auto;
      box-shadow: none;
    }

    .win-card{
      margin-top: 6px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .win-swatch{
      width: 90px;
      height: 90px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.30);
      box-shadow:
        0 18px 50px rgba(0,0,0,0.35),
        inset 0 -10px 22px rgba(0,0,0,0.20);
      background: #2ECC71;
    }
    .win-hex{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 0.8px;
    }

    /* Streamers */
    .streamer{
      position:absolute;
      top:-40px;
      width: 14px;
      height: 260px;
      border-radius: 999px;
      opacity: 0.9;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,0.45));
      animation: sway 1.8s ease-in-out infinite;
      transform-origin: top center;
    }
    @keyframes sway{
      0%,100%{ transform: rotate(-3deg); }
      50%{ transform: rotate(3deg); }
    }

    /* Confetti */
    .confetti{
      position:absolute;
      top:-10px;
      width: 10px;
      height: 16px;
      border-radius: 3px;
      opacity: 0.95;
      animation: fall linear forwards;
    }
    @keyframes fall{
      to{
        transform: translateY(620px) rotate(720deg);
        opacity: 0.9;
      }
    }

    /* little tick pulse on pointer */
    .tickPulse{
      animation: tick 60ms ease-out;
    }
    @keyframes tick{
      from{ transform: translateX(-50%) rotate(0deg) scale(1); }
      to{ transform: translateX(-50%) rotate(0deg) scale(1.06); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stage">
      <div class="header">
        <div>
          <h1>The Patters Pick-o-Maticâ„¢</h1>
          <div class="sub">
            Choosing is tough! You're far too busy for that! Let the wheel of fate decide!
          </div>
        </div>
      </div>

      <div class="wheel-area">
        <div class="pointer" id="pointer"></div>

        <div class="wheel-shell">
          <canvas id="wheel" width="760" height="760" aria-label="Wheel canvas"></canvas>
          <div class="ring"></div>
          <div class="shine"></div>
        </div>
      </div>

      <div class="controls">
        <button id="spinBtn">SPIN</button>
      </div>
    </div>

    <div class="side" id="side">
      <div class="label">Last Result</div>
      <div class="chip">
        <div style="display:flex; align-items:center; gap:12px;">
          <div class="swatch" id="lastSwatch"></div>
          <div>
            <div class="hex" id="lastHex">â€”</div>
            <div class="small" id="lastDesc">Spin to pick a shade.</div>
          </div>
        </div>
        <div class="small" id="lastIdx"> </div>
      </div>

      <div class="divider"></div>

      <div class="panel">
        <div class="label">Patters Colour Picker</div>
        <div class="small">
          Spin the wheel! Everyone's a winner!
        </div>
      </div>

      <div class="celebrate" id="celebrate">
        <div class="celebrate-inner">
          <div class="celebrate-top">
            <div>
              <h2>ðŸŽ‰ Winner!</h2>
              <div class="small">Your shade is locked in. Wooo!</div>
            </div>
            <button class="close" id="closeCelebrate">Close</button>
          </div>

          <div class="win-card">
            <div>
              <div class="label" style="margin:0 0 6px 0;">Selected colour</div>
              <div class="win-hex" id="winHex">#00FF00</div>
              <div class="small" id="winNote"> </div>
            </div>
            <div class="win-swatch" id="winSwatch"></div>
          </div>

          <div class="small" style="margin-top:auto; opacity:0.85;">
            Tip: click the hex in the side panel to copy (itâ€™ll work after your first spin).
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const spinBtn = document.getElementById('spinBtn');
  const pointer = document.getElementById('pointer');

  const lastSwatch = document.getElementById('lastSwatch');
  const lastHex = document.getElementById('lastHex');
  const lastDesc = document.getElementById('lastDesc');
  const lastIdx = document.getElementById('lastIdx');

  const celebrate = document.getElementById('celebrate');
  const closeCelebrate = document.getElementById('closeCelebrate');
  const winHex = document.getElementById('winHex');
  const winSwatch = document.getElementById('winSwatch');
  const winNote = document.getElementById('winNote');

  // Wheel configuration
  const SEGMENTS = 96;            // lots of distinct greens
  const R = canvas.width / 2;
  const center = { x: R, y: R };
  const wheelRadius = R * 0.92;

  // We keep an "angle" in radians that represents wheel rotation.
  // Pointer is fixed at top (i.e., -90Â°).
  let angle = 0;
  let spinning = false;
  let lastTickSegment = null;

  // Generate greens: sweep hue around green band, vary lightness in a pleasing wave.
  // Hue: about 85..155 degrees (yellow-green -> teal-green)
  const colors = Array.from({ length: SEGMENTS }, (_, i) => {
    const t = i / SEGMENTS; // 0..1
    const hue = 85 + 70 * t; // 85..155
    // Lightness varies with a sine to create bright/dark variety
    const light = 34 + 34 * (0.5 + 0.5 * Math.sin((t * Math.PI * 2) - Math.PI/2)); // ~34..68
    const sat = 92; // punchy greens
    const rgb = hslToRgb(hue, sat, light);
    const hex = rgbToHex(rgb[0], rgb[1], rgb[2]);
    return { hue, sat, light, hex, rgb };
  });

  function drawWheel(aRad) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // outer glow
    ctx.save();
    ctx.translate(center.x, center.y);
    ctx.beginPath();
    ctx.arc(0, 0, wheelRadius + 10, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(124,255,178,0.10)';
    ctx.fill();
    ctx.restore();

    const segAngle = (Math.PI * 2) / SEGMENTS;

    ctx.save();
    ctx.translate(center.x, center.y);
    ctx.rotate(aRad);

    for (let i = 0; i < SEGMENTS; i++) {
      const start = i * segAngle;
      const end = start + segAngle;

      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.arc(0, 0, wheelRadius, start, end);
      ctx.closePath();

      ctx.fillStyle = colors[i].hex;
      ctx.fill();

      // segment separator line
      ctx.strokeStyle = 'rgba(255,255,255,0.10)';
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    // inner cutout + subtle gradient for depth
    ctx.beginPath();
    ctx.arc(0, 0, wheelRadius * 0.28, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(0,0,0,0.38)';
    ctx.fill();

    // center cap
    const capR = wheelRadius * 0.18;
    const grd = ctx.createRadialGradient(-capR*0.3, -capR*0.3, capR*0.2, 0, 0, capR);
    grd.addColorStop(0, 'rgba(255,255,255,0.18)');
    grd.addColorStop(1, 'rgba(255,255,255,0.04)');
    ctx.beginPath();
    ctx.arc(0, 0, capR, 0, Math.PI*2);
    ctx.fillStyle = grd;
    ctx.fill();
    ctx.strokeStyle = 'rgba(255,255,255,0.12)';
    ctx.lineWidth = 2;
    ctx.stroke();

    ctx.restore();
  }

  // Determine which segment is under the pointer (top).
  // Pointer direction is -90Â° in canvas coordinates. Our wheel rotates by angle.
  function getSelectedIndex(aRad) {
    const segAngle = (Math.PI * 2) / SEGMENTS;

    // The pointer angle in world coordinates is -90deg = -PI/2.
    // Wheel rotation means segment i's center is at (i+0.5)*segAngle + aRad.
    // We want which segment aligns with pointer: (i+0.5)*segAngle + aRad ~= -PI/2 (mod 2PI)
    // Solve for i:
    let target = normalizeAngle(-Math.PI/2 - aRad);
    // Convert angle to segment index (0 at angle 0)
    let idx = Math.floor(target / segAngle);
    idx = (idx % SEGMENTS + SEGMENTS) % SEGMENTS;
    return idx;
  }

  function normalizeAngle(rad) {
    let a = rad % (Math.PI * 2);
    if (a < 0) a += Math.PI * 2;
    return a;
  }

  function setLastResult(idx) {
    const c = colors[idx];
    lastSwatch.style.background = c.hex;
    lastHex.textContent = c.hex;
    lastDesc.textContent = `Hue ${c.hue.toFixed(0)}Â°, Sat ${c.sat}%, Light ${c.light.toFixed(0)}%`;
    lastIdx.textContent = `Segment ${idx + 1} / ${SEGMENTS}`;
  }

  function showCelebration(idx) {
    const c = colors[idx];
    winHex.textContent = c.hex;
    winSwatch.style.background = c.hex;
    winNote.textContent = `Locked on segment ${idx + 1} of ${SEGMENTS}.`;
    celebrate.classList.add('show');

    spawnStreamers();
    spawnConfetti(90);
  }

  function hideCelebration() {
    celebrate.classList.remove('show');
    // cleanup confetti
    celebrate.querySelectorAll('.confetti, .streamer').forEach(n => n.remove());
  }

  // Make a little visual â€œtickâ€ as segments pass the pointer
  function maybeTick(aRad) {
    const idx = getSelectedIndex(aRad);
    if (idx !== lastTickSegment) {
      lastTickSegment = idx;
      pointer.classList.remove('tickPulse');
      // force reflow for animation restart
      void pointer.offsetWidth;
      pointer.classList.add('tickPulse');
    }
  }

  // Spin animation with easing and a satisfying stop
  async function spin() {
    if (spinning) return;
    spinning = true;
    spinBtn.disabled = true;
    hideCelebration();

    // Randomly choose a target segment to land on
    const targetIndex = Math.floor(Math.random() * SEGMENTS);

    // Compute an angle that lands that segment under pointer.
    // We want getSelectedIndex(finalAngle) === targetIndex.
    // We'll brute compute desired finalAngle by inverting:
    // getSelectedIndex(a) uses target = (-PI/2 - a) mod 2PI, idx = floor(target/segAngle)
    // We can pick a target angle in the middle of the chosen segment:
    const segAngle = (Math.PI * 2) / SEGMENTS;
    const segmentMid = (targetIndex + 0.5) * segAngle;
    // Want: (-PI/2 - finalAngle) mod 2PI == segmentMid
    // => finalAngle == -PI/2 - segmentMid  (mod 2PI)
    const baseFinal = -Math.PI/2 - segmentMid;
    // add many full rotations for drama
    const extraTurns = 7 + Math.floor(Math.random() * 5); // 7..11
    const finalAngle = baseFinal + extraTurns * Math.PI * 2;

    const start = angle;
    const delta = finalAngle - start;

    const duration = 3600 + Math.random() * 1400; // ms
    const t0 = performance.now();

    lastTickSegment = null;

    const animate = (now) => {
      const t = Math.min(1, (now - t0) / duration);
      // Ease out with a slight "snap" at the end:
      const eased = easeOutCubic(t);
      angle = start + delta * eased;

      drawWheel(angle);
      maybeTick(angle);

      if (t < 1) {
        requestAnimationFrame(animate);
      } else {
        // finalize, compute actual selected
        const idx = getSelectedIndex(angle);
        setLastResult(idx);
        showCelebration(idx);
        spinning = false;
        spinBtn.disabled = false;
      }
    };

    requestAnimationFrame(animate);
  }

  function easeOutCubic(t) {
    return 1 - Math.pow(1 - t, 3);
  }

  // Party streamers: tall wiggly ribbons at top
  function spawnStreamers() {
    const colorsStream = ['#B8FFD6','#72FFB5','#54F0FF','#D0FF7C','#FFFFFF'];
    for (let i = 0; i < 9; i++) {
      const s = document.createElement('div');
      s.className = 'streamer';
      const left = Math.random() * 100;
      const h = 180 + Math.random() * 220;
      const w = 10 + Math.random() * 10;
      s.style.left = `${left}%`;
      s.style.height = `${h}px`;
      s.style.width = `${w}px`;
      s.style.background = colorsStream[Math.floor(Math.random()*colorsStream.length)];
      s.style.animationDuration = `${1.3 + Math.random()*1.4}s`;
      s.style.opacity = `${0.75 + Math.random()*0.25}`;
      celebrate.appendChild(s);
    }
  }

  // Confetti: falling pieces
  function spawnConfetti(count=80) {
    const palette = ['#B8FFD6','#72FFB5','#54F0FF','#D0FF7C','#FFFFFF','#9CFFEA'];
    for (let i = 0; i < count; i++) {
      const c = document.createElement('div');
      c.className = 'confetti';
      const left = Math.random() * 100;
      const dur = 1.4 + Math.random() * 1.8;
      const delay = Math.random() * 0.25;
      const sizeW = 6 + Math.random() * 10;
      const sizeH = 8 + Math.random() * 14;

      c.style.left = `${left}%`;
      c.style.width = `${sizeW}px`;
      c.style.height = `${sizeH}px`;
      c.style.background = palette[Math.floor(Math.random()*palette.length)];
      c.style.animationDuration = `${dur}s`;
      c.style.animationDelay = `${delay}s`;

      // some drift
      const drift = (Math.random() * 2 - 1) * 140;
      c.style.transform = `translateY(0px) translateX(${drift}px) rotate(${Math.random()*180}deg)`;
      celebrate.appendChild(c);

      // remove after done
      setTimeout(() => c.remove(), (dur + delay) * 1000 + 50);
    }
  }

  // click-to-copy hex
  function enableCopy(el) {
    el.style.cursor = 'pointer';
    el.title = 'Click to copy';
    el.addEventListener('click', async () => {
      const text = el.textContent.trim();
      if (!text || text === 'â€”') return;
      try {
        await navigator.clipboard.writeText(text);
        const prev = el.textContent;
        el.textContent = 'Copied!';
        setTimeout(() => { el.textContent = prev; }, 700);
      } catch {
        // fallback: no clipboard permission
      }
    });
  }

  // HSL -> RGB conversion
  function hslToRgb(h, s, l) {
    // h in degrees, s/l in percent
    h /= 360; s /= 100; l /= 100;
    let r, g, b;

    if (s === 0) {
      r = g = b = l;
    } else {
      const hue2rgb = (p, q, t) => {
        if (t < 0) t += 1;
        if (t > 1) t -= 1;
        if (t < 1/6) return p + (q - p) * 6 * t;
        if (t < 1/2) return q;
        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
        return p;
      };
      const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      const p = 2 * l - q;
      r = hue2rgb(p, q, h + 1/3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1/3);
    }
    return [Math.round(r*255), Math.round(g*255), Math.round(b*255)];
  }

  function rgbToHex(r,g,b) {
    const toHex = (n) => n.toString(16).padStart(2,'0');
    return `#${toHex(r)}${toHex(g)}${toHex(b)}`.toUpperCase();
  }

  // init
  drawWheel(angle);
  enableCopy(lastHex);
  closeCelebrate.addEventListener('click', hideCelebration);
  spinBtn.addEventListener('click', spin);

  // also close if user clicks outside inner content
  celebrate.addEventListener('click', (e) => {
    if (e.target === celebrate) hideCelebration();
  });
})();
</script>
</body>
</html>

